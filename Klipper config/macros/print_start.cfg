[gcode_macro PRINT_START]
gcode:
	CASELIGHT_ON
	BED_MESH_CLEAR
	
	G90                                    ; Use absolute positioning
    M83                                    ; extruder relative mode
	
	M117 Homing...
    CG28                                   ; home all axes
    SET_GCODE_OFFSET Z={Z_OFFSET} MOVE=1
	
	M140 S{BED_TEMP}                       ; set bed temp
    M141 S{CHAMBER_TEMP}
	MOVE_CENTER                            ; move nozzle away from bed
	
	{% if printer["temperature_fan chamber"].temperature <= CHAMBER_TEMP_MIN %}
        M106 S204
        UPDATE_DELAYED_GCODE ID=HEATER_LIGHT_BLINK DURATION=1
		TEMPERATURE_WAIT SENSOR="temperature_sensor chamber" MINIMUM={CHAMBER_TEMP_MIN}
		UPDATE_DELAYED_GCODE ID=HEATER_LIGHT_BLINK DURATION=0
		M106 S0
    {% endif %}
	
	HEATER_LIGHT_ON
	M190 S{BED_TEMP}    ; wait for bed temp
	
	{% if printer["gcode_macro QUAD_GANTRY_LEVEL"].qgl_done != 1 %}
		QUAD_GANTRY_LEVEL
    {% endif %}
	
	BED_MESH_CALIBRATE
    BED_MESH_PROFILE LOAD=default
	
	G21                                		; set units to millimeters
    G90                                 	; use absolute coordinates
    M83                                   	; use relative distances for extrusion
	
	G1 X 3 Y-3.0 Z0.8 F6000                	; go outside print area
	
	M109 S{EXTRUDER_TEMP}                  	; wait for extruder temp
	
	PRIME_LINE
	
	M117 Printing...